---
import CheckCircleIcon from "@/assets/icons/material-symbols--check-circle.svg";
import Button from "@/components/button.astro";

interface Props {
  commentId: number;
  disabled?: boolean;
}

const { commentId, disabled = false } = Astro.props;
---

<Button
  action="approve-comment"
  data-comment-id={commentId}
  text="Approve"
  icon={CheckCircleIcon}
  color="lime"
  disabled={disabled}
/>

<script>
  import { actions } from "astro:actions";
  document
    .querySelectorAll("button[data-action='approve-comment']")
    .forEach((button) => {
      button.addEventListener("click", async (event) => {
        event.preventDefault();
        const commentId = button.getAttribute("data-comment-id");
        if (!commentId) {
          console.error("Comment ID not found");
          return;
        }
        await actions.approveComment({ id: parseInt(commentId) });
        window.location.reload();
      });
    });
</script>
